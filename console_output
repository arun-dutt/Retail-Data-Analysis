-------------------------------------------
Batch: 0
-------------------------------------------
+----------+-------+---------+----------+-----------+--------+---------+
|invoice_no|country|timestamp|total_cost|total_items|is_order|is_return|
+----------+-------+---------+----------+-----------+--------+---------+
+----------+-------+---------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 1
-------------------------------------------
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost        |total_items|is_order|is_return|
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|154132542774677|United Kingdom|2021-02-07 10:09:12|6.64              |8          |1       |0        |
|154132542774678|United Kingdom|2021-02-07 10:09:13|75.4              |16         |1       |0        |
|154132542774679|Spain         |2021-02-07 10:09:16|41.4              |20         |1       |0        |
|154132542774680|United Kingdom|2021-02-07 10:09:24|1.66              |2          |1       |0        |
|154132542774681|United Kingdom|2021-02-07 10:09:30|2.51              |1          |1       |0        |
|154132542774682|United Kingdom|2021-02-07 10:09:38|61.5              |46         |1       |0        |
|154132542774683|United Kingdom|2021-02-07 10:09:38|31.5              |14         |1       |0        |
|154132542774684|United Kingdom|2021-02-07 10:09:41|-28.65            |15         |0       |1        |
|154132542774685|United Kingdom|2021-02-07 10:09:46|14.76             |6          |1       |0        |
|154132542774686|United Kingdom|2021-02-07 10:09:51|124.89999999999999|50         |1       |0        |
|154132542774687|United Kingdom|2021-02-07 10:09:51|93.28             |211        |1       |0        |
+---------------+--------------+-------------------+------------------+-----------+--------+---------+

-------------------------------------------
Batch: 2
-------------------------------------------
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost        |total_items|is_order|is_return|
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|154132542774688|EIRE          |2021-02-07 10:10:16|14.629999999999999|26         |1       |0        |
|154132542774689|United Kingdom|2021-02-07 10:10:25|30.63             |32         |1       |0        |
|154132542774690|United Kingdom|2021-02-07 10:10:54|-11.8             |4          |0       |1        |
|154132542774691|Israel        |2021-02-07 10:10:55|5.49              |3          |1       |0        |
|154132542774692|United Kingdom|2021-02-07 10:10:56|23.4              |12         |1       |0        |
+---------------+--------------+-------------------+------------------+-----------+--------+---------+

-------------------------------------------
Batch: 3
-------------------------------------------
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost        |total_items|is_order|is_return|
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|154132542774693|United Kingdom|2021-02-07 10:11:15|7.6               |4          |1       |0        |
|154132542774694|United Kingdom|2021-02-07 10:11:18|35.7              |6          |1       |0        |
|154132542774695|United Kingdom|2021-02-07 10:11:21|153.51999999999998|21         |1       |0        |
|154132542774696|United Kingdom|2021-02-07 10:11:47|24.54             |6          |1       |0        |
|154132542774697|United Kingdom|2021-02-07 10:11:52|171.62            |262        |1       |0        |
|154132542774698|Germany       |2021-02-07 10:12:03|8.07              |4          |1       |0        |
+---------------+--------------+-------------------+------------------+-----------+--------+---------+

-------------------------------------------
Batch: 4
-------------------------------------------
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost        |total_items|is_order|is_return|
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|154132542774699|United Kingdom|2021-02-07 10:12:11|17.83             |50         |1       |0        |
|154132542774700|United Kingdom|2021-02-07 10:12:32|-26.88            |24         |0       |1        |
|154132542774701|Spain         |2021-02-07 10:12:39|24.74             |11         |1       |0        |
|154132542774702|United Kingdom|2021-02-07 10:12:46|112.61000000000001|81         |1       |0        |
|154132542774703|United Kingdom|2021-02-07 10:12:55|12.0              |10         |1       |0        |
|154132542774704|United Kingdom|2021-02-07 10:13:04|60.55             |35         |1       |0        |
+---------------+--------------+-------------------+------------------+-----------+--------+---------+

-------------------------------------------
Batch: 5
-------------------------------------------
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost        |total_items|is_order|is_return|
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|154132542774705|United Kingdom|2021-02-07 10:13:07|30.92             |8          |1       |0        |
|154132542774706|United Kingdom|2021-02-07 10:13:16|57.519999999999996|16         |1       |0        |
|154132542774707|United Kingdom|2021-02-07 10:13:23|46.68             |28         |1       |0        |
|154132542774708|United Kingdom|2021-02-07 10:13:25|146.34999999999997|26         |1       |0        |
|154132542774709|United Kingdom|2021-02-07 10:13:32|23.27             |8          |1       |0        |
|154132542774710|Finland       |2021-02-07 10:13:38|91.81             |19         |1       |0        |
|154132542774711|United Kingdom|2021-02-07 10:13:40|20.55             |9          |1       |0        |
|154132542774712|United Kingdom|2021-02-07 10:13:44|-220.45           |103        |0       |1        |
|154132542774713|United Kingdom|2021-02-07 10:13:46|0.55              |1          |1       |0        |
|154132542774714|United Kingdom|2021-02-07 10:13:50|0.84              |2          |1       |0        |
|154132542774715|United Kingdom|2021-02-07 10:13:52|-80.32            |32         |0       |1        |
|154132542774716|Sweden        |2021-02-07 10:13:53|9.29              |13         |1       |0        |
|154132542774717|United Kingdom|2021-02-07 10:13:58|57.74             |28         |1       |0        |
|154132542774718|United Kingdom|2021-02-07 10:13:58|342.6700000000001 |9          |1       |0        |
+---------------+--------------+-------------------+------------------+-----------+--------+---------+

-------------------------------------------
Batch: 6
-------------------------------------------
+---------------+--------------+-------------------+-----------------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost       |total_items|is_order|is_return|
+---------------+--------------+-------------------+-----------------+-----------+--------+---------+
|154132542774719|United Kingdom|2021-02-07 10:14:24|5.050000000000001|2          |1       |0        |
|154132542774720|United Kingdom|2021-02-07 10:14:30|24.92            |14         |1       |0        |
|154132542774721|Belgium       |2021-02-07 10:14:37|8.7              |6          |1       |0        |
|154132542774722|United Kingdom|2021-02-07 10:14:39|6.64             |8          |1       |0        |
|154132542774723|United Kingdom|2021-02-07 10:14:49|483.35           |172        |1       |0        |
|154132542774724|United Kingdom|2021-02-07 10:14:55|182.82           |118        |1       |0        |
+---------------+--------------+-------------------+-----------------+-----------+--------+---------+

-------------------------------------------
Batch: 7
-------------------------------------------
+---------------+--------------+-------------------+-------------------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost         |total_items|is_order|is_return|
+---------------+--------------+-------------------+-------------------+-----------+--------+---------+
|154132542774725|United Kingdom|2021-02-07 10:15:03|21.85              |7          |1       |0        |
|154132542774726|United Kingdom|2021-02-07 10:15:10|749.0299999999997  |734        |1       |0        |
|154132542774727|United Kingdom|2021-02-07 10:15:17|20.7               |9          |1       |0        |
|154132542774728|United Kingdom|2021-02-07 10:15:22|1.17               |3          |1       |0        |
|154132542774729|United Kingdom|2021-02-07 10:15:23|52.8               |16         |1       |0        |
|154132542774730|United Kingdom|2021-02-07 10:15:30|15.010000000000002 |8          |1       |0        |
|154132542774731|United Kingdom|2021-02-07 10:15:35|12.59              |17         |1       |0        |
|154132542774732|United Kingdom|2021-02-07 10:15:49|28.15              |3          |1       |0        |
|154132542774733|United Kingdom|2021-02-07 10:15:53|138.20000000000002 |61         |1       |0        |
|154132542774734|United Kingdom|2021-02-07 10:15:56|-17.490000000000002|14         |0       |1        |
|154132542774735|United Kingdom|2021-02-07 10:16:00|66.7               |29         |1       |0        |
+---------------+--------------+-------------------+-------------------+-----------+--------+---------+

-------------------------------------------
Batch: 8
-------------------------------------------
+---------------+--------------+-------------------+-------------------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost         |total_items|is_order|is_return|
+---------------+--------------+-------------------+-------------------+-----------+--------+---------+
|154132542774736|United Kingdom|2021-02-07 10:16:07|18.4               |4          |1       |0        |
|154132542774737|United Kingdom|2021-02-07 10:16:20|6.68               |2          |1       |0        |
|154132542774738|United Kingdom|2021-02-07 10:16:21|-17.700000000000003|6          |0       |1        |
|154132542774739|United Kingdom|2021-02-07 10:16:25|49.15              |29         |1       |0        |
|154132542774740|United Kingdom|2021-02-07 10:16:26|55.49999999999999  |38         |1       |0        |
|154132542774741|United Kingdom|2021-02-07 10:16:32|42.29              |76         |1       |0        |
|154132542774742|United Kingdom|2021-02-07 10:16:34|58.36              |16         |1       |0        |
|154132542774743|United Kingdom|2021-02-07 10:16:36|306.0              |72         |1       |0        |
|154132542774744|United Kingdom|2021-02-07 10:16:45|59.1               |26         |1       |0        |
|154132542774745|United Kingdom|2021-02-07 10:16:51|-1.63              |1          |0       |1        |
|154132542774746|Spain         |2021-02-07 10:16:55|291.9              |162        |1       |0        |
|154132542774747|United Kingdom|2021-02-07 10:16:55|34.63              |11         |1       |0        |
|154132542774748|United Kingdom|2021-02-07 10:16:56|13.440000000000001 |16         |1       |0        |
|154132542774749|United Kingdom|2021-02-07 10:16:59|12.48              |6          |1       |0        |
|154132542774750|United Kingdom|2021-02-07 10:16:59|28.76              |12         |1       |0        |
+---------------+--------------+-------------------+-------------------+-----------+--------+---------+

-------------------------------------------
Batch: 9
-------------------------------------------
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost        |total_items|is_order|is_return|
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|154132542774751|United Kingdom|2021-02-07 10:17:07|20.849999999999998|7          |1       |0        |
|154132542774752|United Kingdom|2021-02-07 10:17:09|2.46              |1          |1       |0        |
|154132542774753|United Kingdom|2021-02-07 10:17:12|3.29              |1          |1       |0        |
|154132542774754|United Kingdom|2021-02-07 10:17:42|9.870000000000001 |3          |1       |0        |
|154132542774755|United Kingdom|2021-02-07 10:18:01|32.47             |6          |1       |0        |
|154132542774756|United Kingdom|2021-02-07 10:18:02|10.5              |25         |1       |0        |
|154132542774757|United Kingdom|2021-02-07 10:18:19|17.5              |14         |1       |0        |
|154132542774758|United Kingdom|2021-02-07 10:18:24|11.33             |25         |1       |0        |
+---------------+--------------+-------------------+------------------+-----------+--------+---------+

-------------------------------------------
Batch: 10
-------------------------------------------
+---------------+--------------+-------------------+-------------------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost         |total_items|is_order|is_return|
+---------------+--------------+-------------------+-------------------+-----------+--------+---------+
|154132542774759|United Kingdom|2021-02-07 10:19:04|122.39999999999999 |48         |1       |0        |
|154132542774760|United Kingdom|2021-02-07 10:19:07|-19.2              |10         |0       |1        |
|154132542774761|United Kingdom|2021-02-07 10:19:07|71.4               |12         |1       |0        |
|154132542774762|United Kingdom|2021-02-07 10:19:11|1.63               |1          |1       |0        |
|154132542774763|Denmark       |2021-02-07 10:19:15|165.66             |193        |1       |0        |
|154132542774764|United Kingdom|2021-02-07 10:19:24|68.21000000000001  |19         |1       |0        |
|154132542774765|United Kingdom|2021-02-07 10:19:26|39.86              |18         |1       |0        |
|154132542774766|United Kingdom|2021-02-07 10:19:27|73.17999999999999  |30         |1       |0        |
|154132542774767|United Kingdom|2021-02-07 10:19:36|2.95               |1          |1       |0        |
|154132542774768|United Kingdom|2021-02-07 10:19:41|39.6               |8          |1       |0        |
|154132542774769|United Kingdom|2021-02-07 10:19:50|63.56              |33         |1       |0        |
|154132542774770|United Kingdom|2021-02-07 10:19:52|102.0              |8          |1       |0        |
|154132542774771|United Kingdom|2021-02-07 10:19:53|15.580000000000002 |6          |1       |0        |
|154132542774772|United Kingdom|2021-02-07 10:19:57|-20.200000000000003|8          |0       |1        |
|154132542774773|United Kingdom|2021-02-07 10:19:57|23.12              |28         |1       |0        |
+---------------+--------------+-------------------+-------------------+-----------+--------+---------+

-------------------------------------------
Batch: 11
-------------------------------------------
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost        |total_items|is_order|is_return|
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|154132542774774|United Kingdom|2021-02-07 10:20:08|4.96              |1          |1       |0        |
|154132542774775|United Kingdom|2021-02-07 10:20:19|147.3             |38         |1       |0        |
|154132542774776|United Kingdom|2021-02-07 10:20:20|18.630000000000003|5          |1       |0        |
|154132542774777|United Kingdom|2021-02-07 10:20:23|9.899999999999999 |6          |1       |0        |
|154132542774778|United Kingdom|2021-02-07 10:20:27|10.79             |1          |1       |0        |
|154132542774779|United Kingdom|2021-02-07 10:20:49|88.95             |18         |1       |0        |
|154132542774780|United Kingdom|2021-02-07 10:20:50|24.3              |9          |1       |0        |
+---------------+--------------+-------------------+------------------+-----------+--------+---------+

-------------------------------------------
Batch: 12
-------------------------------------------
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost        |total_items|is_order|is_return|
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|154132542774781|Germany       |2021-02-07 10:21:00|4.95              |1          |1       |0        |
|154132542774782|United Kingdom|2021-02-07 10:21:04|41.25             |11         |1       |0        |
|154132542774783|Portugal      |2021-02-07 10:21:15|112.44000000000001|20         |1       |0        |
|154132542774784|United Kingdom|2021-02-07 10:21:36|15.0              |4          |1       |0        |
|154132542774785|United Kingdom|2021-02-07 10:21:40|49.57             |36         |1       |0        |
|154132542774786|United Kingdom|2021-02-07 10:21:40|45.4              |39         |1       |0        |
|154132542774787|Belgium       |2021-02-07 10:21:40|13.85             |6          |1       |0        |
|154132542774788|United Kingdom|2021-02-07 10:21:46|212.34000000000003|78         |1       |0        |
|154132542774789|United Kingdom|2021-02-07 10:21:51|227.46999999999997|154        |1       |0        |
|154132542774790|United Kingdom|2021-02-07 10:21:52|29.439999999999998|14         |1       |0        |
+---------------+--------------+-------------------+------------------+-----------+--------+---------+

-------------------------------------------
Batch: 13
-------------------------------------------
+---------------+--------------+-------------------+-------------------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost         |total_items|is_order|is_return|
+---------------+--------------+-------------------+-------------------+-----------+--------+---------+
|154132542774791|United Kingdom|2021-02-07 10:21:56|94.75000000000001  |47         |1       |0        |
|154132542774792|United Kingdom|2021-02-07 10:21:56|67.67              |55         |1       |0        |
|154132542774793|United Kingdom|2021-02-07 10:21:59|-21.080000000000002|9          |0       |1        |
|154132542774794|United Kingdom|2021-02-07 10:22:03|297.36             |72         |1       |0        |
|154132542774795|United Kingdom|2021-02-07 10:22:04|20.4               |24         |1       |0        |
|154132542774796|Finland       |2021-02-07 10:22:13|8.25               |1          |1       |0        |
|154132542774797|United Kingdom|2021-02-07 10:22:20|31.169999999999998 |13         |1       |0        |
|154132542774798|United Kingdom|2021-02-07 10:22:20|39.599999999999994 |24         |1       |0        |
|154132542774799|United Kingdom|2021-02-07 10:22:47|1085.43            |680        |1       |0        |
|154132542774800|United Kingdom|2021-02-07 10:22:48|45.84              |10         |1       |0        |
|154132542774801|United Kingdom|2021-02-07 10:22:48|107.17999999999999 |40         |1       |0        |
|154132542774802|United Kingdom|2021-02-07 10:22:54|5.79               |1          |1       |0        |
+---------------+--------------+-------------------+-------------------+-----------+--------+---------+

-------------------------------------------
Batch: 14
-------------------------------------------
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost        |total_items|is_order|is_return|
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|154132542774803|United Kingdom|2021-02-07 10:22:56|192.23999999999998|97         |1       |0        |
|154132542774804|United Kingdom|2021-02-07 10:22:59|6.41              |2          |1       |0        |
|154132542774805|United Kingdom|2021-02-07 10:23:03|32.07             |17         |1       |0        |
|154132542774806|United Kingdom|2021-02-07 10:23:03|7.46              |1          |1       |0        |
|154132542774807|United Kingdom|2021-02-07 10:23:09|63.57000000000001 |35         |1       |0        |
|154132542774808|Netherlands   |2021-02-07 10:23:11|31.6              |24         |1       |0        |
|154132542774809|France        |2021-02-07 10:23:14|6.59              |2          |1       |0        |
|154132542774810|United Kingdom|2021-02-07 10:23:17|15.18             |4          |1       |0        |
|154132542774811|United Kingdom|2021-02-07 10:23:20|40.7              |12         |1       |0        |
|154132542774812|United Kingdom|2021-02-07 10:23:24|81.66             |30         |1       |0        |
|154132542774813|Cyprus        |2021-02-07 10:23:24|14.309999999999999|16         |1       |0        |
|154132542774814|United Kingdom|2021-02-07 10:23:28|672.62            |270        |1       |0        |
|154132542774815|United Kingdom|2021-02-07 10:23:44|3.75              |3          |1       |0        |
|154132542774816|United Kingdom|2021-02-07 10:23:45|19.95             |13         |1       |0        |
+---------------+--------------+-------------------+------------------+-----------+--------+---------+

-------------------------------------------
Batch: 15
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132542774817|United Kingdom|2021-02-07 10:23:54|10.2      |4          |1       |0        |
|154132542774818|United Kingdom|2021-02-07 10:23:59|289.32    |172        |1       |0        |
|154132542774819|United Kingdom|2021-02-07 10:24:03|47.4      |26         |1       |0        |
|154132542774820|United Kingdom|2021-02-07 10:24:10|5.41      |4          |1       |0        |
|154132542774821|United Kingdom|2021-02-07 10:24:10|3.38      |3          |1       |0        |
|154132542774822|United Kingdom|2021-02-07 10:24:15|27.9      |9          |1       |0        |
|154132542774823|United Kingdom|2021-02-07 10:24:29|25.35     |30         |1       |0        |
|154132542774824|United Kingdom|2021-02-07 10:24:36|71.62     |21         |1       |0        |
|154132542774825|United Kingdom|2021-02-07 10:24:40|20.09     |5          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

^CTraceback (most recent call last):
  File "/root/spark-streaming.py", line 160, in <module>
    queryByTimeNCountry.awaitTermination()
  File "/opt/cloudera/parcels/SPARK2-2.3.0.cloudera2-1.cdh5.13.3.p0.316101/lib/spark2//python/lib/pyspark.zip/pyspark/sql/streaming.py", line 106, in awaitTermination
  File "/opt/cloudera/parcels/SPARK2-2.3.0.cloudera2-1.cdh5.13.3.p0.316101/lib/spark2//python/lib/py4j-0.10.6-src.zip/py4j/java_gateway.py", line 1158, in __call__
  File "/opt/cloudera/parcels/SPARK2-2.3.0.cloudera2-1.cdh5.13.3.p0.316101/lib/spark2//python/lib/py4j-0.10.6-src.zip/py4j/java_gateway.py", line 908, in send_command
  File "/opt/cloudera/parcels/SPARK2-2.3.0.cloudera2-1.cdh5.13.3.p0.316101/lib/spark2//python/lib/py4j-0.10.6-src.zip/py4j/java_gateway.py", line 1055, in send_command
  File "/opt/cloudera/parcels/Anaconda/lib/python2.7/socket.py", line 451, in readline
    data = self._sock.recv(self._rbufsize)
  File "/opt/cloudera/parcels/SPARK2-2.3.0.cloudera2-1.cdh5.13.3.p0.316101/lib/spark2//python/lib/pyspark.zip/pyspark/context.py", line 234, in signal_handler
KeyboardInterrupt
